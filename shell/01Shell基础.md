# Shell 基础

`Shell` 脚本通常是以 `.sh` 为后缀。

## Shell 的第一行
`Shell` 程序的第一行通常以以下几种方式开始。这几种开头指定用那个程序来编译和执行脚本。
``` sh
#!/bin/bash
#!/bin/sh
#!/bin/csh
```

## Shell 的注释
在 `Shell` 中使用 `#` 号进行行注释

## 变量的命名/类型/赋值

### 变量命名
* 变量的命名必须以字幕或下划线开头，后面可以跟字母数字或下划线。然后可以使用任何字符做为变量名的结束。
* 变量名是大小写敏感的

### 变量赋值
* 等号两边不能有空格
* 如果要给变量赋空值，可以在等号后面跟一个换行符
  ```sh
  variable=value
  ```

### 变量类型
* 根据变量的作用域，变量可以分为本地变量和环境变量
* 本地变量只能在创建他们的 `shell` 程序中可用。而环境变量则在 `shell` 中的所有用户进程中可用，通常也称为*全局变量*

**我们可以开启两个 `shell` 窗口来进行实验：**

在第一个窗口中我们创建一个变量 A, 然后使用 `echo` 命令打印 A 的值, 我们可以看到打印的结果是 100。但是当我们切换到第二个窗口使用 `echo` 命令打印 A 的值，它显示的是空内容，也就是说无法找到这个变量。
```sh
$ A=100
$ echo A
```

我们可以使用 `export` 命令来将一个变量修改为全局变量，在这样操作后在两个窗口使用 `echo` 命令就都可以正确的打印变量 A 的值了。
```sh
$ A=100
$ export A
$ echo A
```

## 变量常见操作

### 显示变量的值

可以使用 `echo` 命令打印变量的值，在变量的开始前使用 `$` 符 `echo $variable`，或者使用 `$` 符的同时用 `{}`包裹变量 `echo ${variable}`。这两者没有什么太大的区别，后面的一种方式主要是可以跟上其它普通的字符文本，例如下面的输出结果是 **100B**。
```sh
$ A=100
$ echo ${A}B
```

### 清除变量
使用 `unset` 命令可以清除全局变量，如 `unset A`。

### 显示所有变量
使用 `set` 显示所有定义变量，使用 `env` 可以显示环境变量。

### 环境变量和只读变量
* 环境变量称为全局变量，通常需要大写。`export A`
* 只读变量是指不能被清除或重新赋值的变量。
  ```sh
  $ readonly A=200
  $ A = 300 # 这里会提示错误
  ```

### 位置参量 (命令行参数)
在 `shell` 中使用 `$1`，`$2` 到 `$9` 等来表示参数列表，从第10个参数开始需要用大括号包裹，如 `${10}` 表示第是10个参数

**位置参量列表**
命令|作用 
--|:--
$0 | 当前脚本的文件名 
$[1-9] | 第1个到第9个位置参数
${10} | 第10个位置参量，类似的，有 ${11} ,...
$# | 位置参量的个数
$* | 以单字符串显示所有位置参量
$@ | 未加双引号时与 `$*` 含义相同，加双引号时有区别
$$ | 脚本运行的当前进程号
$! | 最后一个后台运行的进程的进程号
$? | 显示前面最后一个命令的退出状态。 0 表示没有错误，其它任何值表示有错误。

我们可以创建一个 `test.sh` 的 `shell` 文件输入这些命令进行测试。在 `shell` 命令行中输入下面命令即可查看对应命令的结果
```sh
$ ./test.sh 100 200
$ echo $!
```

针对 `$?` 可以做以下测试
```sh
$ man m
$ echo $?
$ man test
$ echo $?
```
另外我们也可以在 `.sh` 文件中使用 `exit` 命令来执行退出，如在 `.sh` 的文件末尾添加 `exit 100`。 然后在控制台命令行执行 `echo $?` 可以查看结果。

## 数组
### 数组的定义
`arr=(A B C)`, 这里定义了数组 `arr`，有 `A`, `B`, `C` 三个元素。可以直接对数组重新赋值，如：`arr=(D E F)`

### 使用数组
* `${arr[0]}` 表示数组第一个元素
* `${#arr[*]}` 表示数组元素个数
* `${arr[*]}` 表示数组所有元素

`shell` 中允许设置数组中指定位置的值，如 `arr[6]=F`，那么数组的第7个元素的值就是 `F`，但是第3到6的位置没有元素，而且数组的个数是4。
```sh
$ arr[6]=F
$ echo ${arr[6]}
$ echo ${arr[4]}
$ echo ${#arr[*]}
```